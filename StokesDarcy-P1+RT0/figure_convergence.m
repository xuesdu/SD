%% nu = 1; K = 1;
e_us11 = [5.90e-02	 1.64e-02	 4.30e-03	 1.09e-03    2.73e-04];
e_ps11 = [1.20e+00	 5.04e-01	 2.30e-01	 1.10e-01    5.41e-02];	 
e_ud11 = [8.20e-01	 4.16e-01	 2.09e-01	 1.05e-01    5.23e-02]; 
e_pd11 = [1.25e+00	 6.46e-01	 3.65e-02	 1.82e-02    9.12e-03];	 

%% nu  =1; K = 1e-2;
e_us12 = [5.61e-02	 1.51e-02	 3.86e-03	 9.72e-04    2.43e-04];
e_ps12 = [1.20e+00	 5.07e-01	 2.31e-01	 1.10e-01    5.41e-02];
e_ud12 = [8.20e-01	 4.16e-01	 2.09e-01	 1.05e-01    5.23e-02];
e_pd12 = [2.19e-02	 7.48e-03	 3.37e-03	 1.68e-03    8.52e-04]./(1e-2);


%% nu = 1; K = 1e-4;
e_us14 = [5.43e-02	 1.44e-02	 3.65e-03	 9.17e-04    2.29e-04];
e_ps14 = [1.28e+00	 5.17e-01	 2.32e-01	 1.10e-01    5.41e-02];
e_ud14 = [8.20e-01	 4.16e-01	 2.09e-01	 1.05e-01    5.23e-02]; 
e_pd14 = [2.00e-02	 4.91e-03	 1.22e-03	 3.04e-04    7.59e-05]./(1e-4);	 

%% nu = 1; K = 1e-6;
e_us16 = [5.29e-02	 1.42e-02	 3.62e-03	 9.10e-04    2.28e-04];
e_ps16 = [1.21e+00	 5.07e-01	 2.30e-01	 1.10e-01    5.40e-02];	 
e_ud16 = [8.19e-01	 4.16e-01	 2.09e-01	 1.05e-01    5.23e-02];	 
e_pd16 = [1.78e-02	 4.37e-03	 1.09e-03	 2.71e-04    6.78e-05]./(1e-6);	 

%% nu = 1e-2; K = 1;
e_us21 = [5.90e-02	 1.64e-02	 4.30e-03	 1.09e-03    2.73e-04];	 
e_ps21 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02    3.07e-02];	 
e_ud21 = [8.20e-01	 4.16e-01	 2.09e-01	 1.05e-01    5.23e-02]; 
e_pd21 = [1.44e-01	 7.29e-02	 3.64e-02	 1.82e-02    9.12e-03];	

%% nu = 1e-2; K = 1e-2;
e_us22 = [5.61e-02	 1.51e-02	 3.86e-03	 9.72e-04    2.43e-04];	 
e_ps22 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02    3.07e-02];	 
e_ud22 = [8.20e-01	 4.16e-01	 2.09e-01	 1.05e-01    5.23e-02];	 
e_pd22 = [1.45e-03	 7.30e-04	 3.66e-04	 1.83e-04    9.13e-05]./(1e-2);

%% nu = 1e-2; K = 1e-4; 
e_us24 = [5.43e-02	 1.44e-02	 3.65e-03	 9.17e-04    2.29e-04];	 
e_ps24 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02    3.07e-02];	 
e_ud24 = [8.20e-01	 4.16e-01	 2.09e-01	 1.05e-01    5.23e-02];
e_pd24 = [2.01e-04	 4.96e-05	 1.27e-05	 3.55e-06    1.19e-06]./(1e-4);

%% nu = 1e-2; K = 1e-6;
e_us26 = [5.29e-02	 1.42e-02	 3.62e-03	 9.10e-04    2.28e-04];	 
e_ps26 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02    3.07e-02];	 
e_ud26 = [8.19e-01	 4.16e-01	 2.09e-01	 1.05e-01    5.23e-02];	 
e_pd26 = [1.78e-04	 4.37e-05	 1.09e-05	 2.71e-06    6.78e-07]./(1e-6);

%% nu = 1e-4; K = 1;
e_us41 = [5.91e-02	 1.64e-02	 4.30e-03	 1.09e-03    2.73e-04];
e_ps41 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02    3.07e-02];	 
e_ud41 = [8.20e-01	 4.16e-01	 2.09e-01	 1.05e-01    5.23e-02];	 
e_pd41 = [1.44e-01	 7.27e-02	 3.64e-02	 1.82e-02    9.12e-03];

%% nu = 1e-4; K = 1e-2;	 
e_us42 = [5.61e-02	 1.51e-02	 3.86e-03	 9.72e-04    2.43e-04]; 
e_ps42 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02    3.07e-02];	 
e_ud42 = [8.20e-01	 4.16e-01	 2.09e-01	 1.05e-01    5.23e-02];	 
e_pd42 = [1.44e-03	 7.27e-04	 3.64e-04	 1.82e-04    9.12e-05]./(1e-2);

%% nu = 1e-4; K = 1e-4;	 
e_us44 = [5.43e-02	 1.44e-02	 3.65e-03	 9.17e-04    2.29e-04];	 
e_ps44 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02    3.07e-02];	 
e_ud44 = [8.20e-01	 4.16e-01	 2.09e-01	 1.05e-01    5.23e-02];	 
e_pd44 = [1.45e-05	 7.28e-06	 3.65e-06	 1.82e-06    9.12e-07]./(1e-4);

%% nu = 1e-4; K = 1e-6;	 
e_us46 = [5.29e-02	 1.42e-02	 3.62e-03	 9.10e-04    2.28e-04];	 
e_ps46 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02    3.07e-02];	 
e_ud46 = [8.19e-01	 4.16e-01	 2.09e-01	 1.05e-01    5.23e-02];	 
e_pd46 = [1.79e-06	 4.43e-07	 1.15e-07	 3.27e-08    1.14e-08]./(1e-6);	 


%% nu = 1e-6; K = 1;
e_us61 = [6.06e-02	 1.66e-02	 4.30e-03	 1.09e-03    2.73e-04];	 
e_ps61 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02    3.07e-02];	 
e_ud61 = [8.85e-01	 4.17e-01	 2.09e-01	 1.05e-01    5.23e-02];	 
e_pd61 = [1.44e-01	 7.27e-02	 3.64e-02	 1.82e-02    9.12e-03];

%% nu = 1e-6; K = 1e-2;
e_us62 = [5.74e-02	 1.51e-02	 3.87e-03	 9.72e-04    2.43e-04]; 
e_ps62 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02    3.07e-02];	 
e_ud62 = [8.20e-01	 4.16e-01	 2.09e-01	 1.05e-01    5.23e-02];	 
e_pd62 = [1.44e-03	 7.27e-04	 3.64e-04	 1.82e-04    9.12e-05]./(1e-2);

%% nu = 1e-6; K = 1e-4;	 
e_us64 = [5.54e-02	 1.44e-02	 3.65e-03	 9.17e-04    2.29e-04];	 
e_ps64 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02    3.07e-02]; 
e_ud64 = [8.20e-01	 4.16e-01	 2.09e-01	 1.05e-01    5.23e-02];	 
e_pd64 = [1.44e-05	 7.27e-06	 3.64e-06	 1.82e-06    9.12e-07]./(1e-4);

%% nu = 1e-6; K = 1e-6;	 
e_us66 = [5.39e-02	 1.42e-02	 3.62e-03	 9.10e-04    2.28e-04];	 
e_ps66 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02    3.07e-02];	 
e_ud66 = [8.19e-01	 4.16e-01	 2.09e-01	 1.05e-01    5.23e-02];	 
e_pd66 = [1.45e-07	 7.28e-08	 3.65e-08	 1.82e-08    9.12e-09]./(1e-6); 


%% us
figure('units','normalized','position',[0.15,0.3,0.75,0.3])
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
N = log([4,8,16,32,64]);plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us11 = log(e_us11); plot(N,e_us11,'o-','LineWidth',2); 
e_us12 = log(e_us12); plot(N,e_us12,'o-','LineWidth',2); 
e_us14 = log(e_us14); plot(N,e_us14,'o-','LineWidth',2); 
e_us16 = log(e_us16); plot(N,e_us16,'o-','LineWidth',2); 
title('$\mu = 1$','Interpreter','latex'); box on;

a2 = nexttile; hold on;
plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us21 = log(e_us21); plot(N,e_us21,'o-','LineWidth',2); 
e_us22 = log(e_us22); plot(N,e_us22,'o-','LineWidth',2); 
e_us24 = log(e_us24); plot(N,e_us24,'o-','LineWidth',2); 
e_us26 = log(e_us26); plot(N,e_us26,'o-','LineWidth',2); 
title('$\mu = 1e-2$','Interpreter','latex'); box on;

a3 = nexttile; hold on;
plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us41 = log(e_us41); plot(N,e_us41,'o-','LineWidth',2); 
e_us42 = log(e_us42); plot(N,e_us42,'o-','LineWidth',2); 
e_us44 = log(e_us44); plot(N,e_us44,'o-','LineWidth',2); 
e_us46 = log(e_us46); plot(N,e_us46,'o-','LineWidth',2); 
title('$\mu = 1e-4$','Interpreter','latex'); box on;

a4 = nexttile; hold on;
plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us61 = log(e_us61); plot(N,e_us61,'o-','LineWidth',2); 
e_us62 = log(e_us62); plot(N,e_us62,'o-','LineWidth',2); 
e_us64 = log(e_us64); plot(N,e_us64,'o-','LineWidth',2); 
e_us66 = log(e_us66); plot(N,e_us66,'o-','LineWidth',2); 
title('$\mu = 1e-6$','Interpreter','latex'); box on;

linkaxes([a1 a2 a3 a4],'xy')
legend('2-nd order slope','$k = 1e-0$','$k = 1e-2$','$k = 1e-4$', '$k = 1e-6$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex')
xlabel(t,'Mesh Size')
ylabel(t,'$\| \mathbf{u}_S - \mathbf{u}_{S,h} \|_{0}$', 'Interpreter','latex')

%% ps 
figure('units','normalized','position',[0.15,0.3,0.75,0.3])
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps11 = log(e_ps11); plot(N,e_ps11,'o-','LineWidth',2); 
e_ps12 = log(e_ps12); plot(N,e_ps12,'o-','LineWidth',2); 
e_ps14 = log(e_ps14); plot(N,e_ps14,'o-','LineWidth',2); 
e_ps16 = log(e_ps16); plot(N,e_ps16,'o-','LineWidth',2); 
%legend('1-nd order slope', 'K = 1e-0','K = 1e-2','K = 1e-4', 'K = 1e-6');
title('$\mu = 1$','Interpreter','latex'); box on;

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps21 = log(e_ps21); plot(N,e_ps21,'o-','LineWidth',2); 
e_ps22 = log(e_ps22); plot(N,e_ps22,'o-','LineWidth',2); 
e_ps24 = log(e_ps24); plot(N,e_ps24,'o-','LineWidth',2); 
e_ps26 = log(e_ps26); plot(N,e_ps26,'o-','LineWidth',2); 
%legend('1-nd order slope', 'K = 1e-0','K = 1e-2','K = 1e-4', 'K = 1e-6');
title('$\mu = 1e-2$','Interpreter','latex'); box on;

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps41 = log(e_ps41); plot(N,e_ps41,'o-','LineWidth',2); 
e_ps42 = log(e_ps42); plot(N,e_ps42,'o-','LineWidth',2); 
e_ps44 = log(e_ps44); plot(N,e_ps44,'o-','LineWidth',2); 
e_ps46 = log(e_ps46); plot(N,e_ps46,'o-','LineWidth',2); 
title('$\mu = 1e-4$','Interpreter','latex'); box on;

a4 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps61 = log(e_ps61); plot(N,e_ps61,'o-','LineWidth',2); 
e_ps62 = log(e_ps62); plot(N,e_ps62,'o-','LineWidth',2); 
e_ps64 = log(e_ps64); plot(N,e_ps64,'o-','LineWidth',2); 
e_ps66 = log(e_ps66); plot(N,e_ps66,'o-','LineWidth',2); 
title('$\mu = 1e-6$','Interpreter','latex'); box on;

linkaxes([a1 a2 a3 a4],'xy')
legend('1-nd order slope','$k = 1e-0$','$k = 1e-2$','$k = 1e-4$', '$k = 1e-6$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex')
xlabel(t,'Mesh size')
ylabel(t,'$\| p_S - p_{S,h} \|_{0}$', 'Interpreter','latex')

%% ud
figure('units','normalized','position',[0.15,0.3,0.75,0.3])
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud11 = log(e_ud11); plot(N,e_ud11,'o-','LineWidth',2); 
e_ud12 = log(e_ud12); plot(N,e_ud12,'o-','LineWidth',2); 
e_ud14 = log(e_ud14); plot(N,e_ud14,'o-','LineWidth',2); 
e_ud16 = log(e_ud16); plot(N,e_ud16,'o-','LineWidth',2); 
title('$\mu = 1$','Interpreter','latex'); box on;

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud21 = log(e_ud21); plot(N,e_ud21,'o-','LineWidth',2); 
e_ud22 = log(e_ud22); plot(N,e_ud22,'o-','LineWidth',2); 
e_ud24 = log(e_ud24); plot(N,e_ud24,'o-','LineWidth',2); 
e_ud26 = log(e_ud26); plot(N,e_ud26,'o-','LineWidth',2); 
title('$\mu = 1e-2$','Interpreter','latex'); box on;

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud41 = log(e_ud41); plot(N,e_ud41,'o-','LineWidth',2); 
e_ud42 = log(e_ud42); plot(N,e_ud42,'o-','LineWidth',2); 
e_ud44 = log(e_ud44); plot(N,e_ud44,'o-','LineWidth',2); 
e_ud46 = log(e_ud46); plot(N,e_ud46,'o-','LineWidth',2); 
title('$\mu = 1e-4$','Interpreter','latex'); box on;

a4 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud61 = log(e_ud61); plot(N,e_ud61,'o-','LineWidth',2); 
e_ud62 = log(e_ud62); plot(N,e_ud62,'o-','LineWidth',2); 
e_ud64 = log(e_ud64); plot(N,e_ud64,'o-','LineWidth',2); 
e_ud66 = log(e_ud66); plot(N,e_ud66,'o-','LineWidth',2); 
title('$\mu = 1e-6$','Interpreter','latex'); box on;

linkaxes([a1 a2 a3 a4],'xy')
legend('1-nd order slope','$k = 1e-0$','$k = 1e-2$','$k = 1e-4$', '$k = 1e-6$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex')
xlabel(t,'Mesh Size')
ylabel(t,'$\| \mathbf{u}_D - \mathbf{u}_{D,h} \|_{0}$', 'Interpreter','latex')


%% pd 
figure('units','normalized','position',[0.15,0.3,0.75,0.3])
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_pd11 = log(e_pd11); plot(N,e_pd11,'o-','LineWidth',2); 
e_pd12 = log(e_pd12); plot(N,e_pd12,'o-','LineWidth',2); 
e_pd14 = log(e_pd14); plot(N,e_pd14,'o-','LineWidth',2); 
e_pd16 = log(e_pd16); plot(N,e_pd16,'o-','LineWidth',2); 
box on;
title('$\mu = 1$','Interpreter','latex');

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_pd21 = log(e_pd21); plot(N,e_pd21,'o-','LineWidth',2); 
e_pd22 = log(e_pd22); plot(N,e_pd22,'o-','LineWidth',2); 
e_pd24 = log(e_pd24); plot(N,e_pd24,'o-','LineWidth',2); 
e_pd26 = log(e_pd26); plot(N,e_pd26,'o-','LineWidth',2); 
box on;
title('$\mu = 1e-2$','Interpreter','latex');

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %1nd order slope
e_pd41 = log(e_pd41); plot(N,e_pd41,'o-','LineWidth',2); 
e_pd42 = log(e_pd42); plot(N,e_pd42,'o-','LineWidth',2); 
e_pd44 = log(e_pd44); plot(N,e_pd44,'o-','LineWidth',2); 
e_pd46 = log(e_pd46); plot(N,e_pd46,'o-','LineWidth',2); 
box on;
title('$\mu = 1e-4$','Interpreter','latex');

a4 = nexttile; hold on; 
plot(N,-N,'--','LineWidth',2)   %1nd order slope
e_pd61 = log(e_pd61); plot(N,e_pd61,'o-','LineWidth',2); 
e_pd62 = log(e_pd62); plot(N,e_pd62,'o-','LineWidth',2); 
e_pd64 = log(e_pd64); plot(N,e_pd64,'o-','LineWidth',2); 
e_pd66 = log(e_pd66); plot(N,e_pd66,'o-','LineWidth',2); 
box on; 
title('$\mu = 1e-6$','Interpreter','latex');

linkaxes([a1 a2 a3 a4],'xy')
legend('1-nd order slope','$k = 1e-0$','$k = 1e-2$','$k = 1e-4$', '$k = 1e-6$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex')
xlabel(t,'Mesh Size')
ylabel(t,'$\| p_D - p_{D,h} \|_{0}$', 'Interpreter','latex')
