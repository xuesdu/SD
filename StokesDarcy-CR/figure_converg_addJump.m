% the results: add the jump term on the interface
% nu = 1; k = 1;
e_us11 = [2.13e-02         5.63e-03        1.43e-03        3.57e-04         8.91e-05];        
e_ps11 = [3.35e-01         1.60e-01        7.68e-02        3.75e-02         1.86e-02];       
e_ud11 = [3.08e-01         1.45e-01        6.96e-02        3.40e-02         1.67e-02];       
e_pd11 = [7.41e-02         3.66e-02        1.83e-02        9.12e-03         4.56e-03];

% nu = 1; k = 1e-2;
e_us12 = [3.17e-02         7.78e-03        1.82e-03        4.20e-04         9.76e-05];       
e_ps12 = [3.77e-01         1.83e-01        8.55e-02        4.03e-02         1.94e-02];       
e_ud12 = [3.15e-01         1.47e-01        7.04e-02        3.42e-02         1.68e-02];        
e_pd12 = [1.31e+00         3.46e-01        9.24e-02        2.58e-02         7.97e-03];

% nu = 1; k = 1e-4;
e_us14 = [8.56e-02         2.85e-02        9.16e-03        2.93e-03         9.26e-04];       
e_ps14 = [1.46e+00         7.15e-01        4.30e-01        2.54e-01         1.45e-01];       
e_ud14 = [3.36e-01         1.60e-01        7.74e-02        3.77e-02         1.84e-02];       
e_pd14 = [1.40e+02         3.62e+01        9.35e+00        2.44e+00         6.47e-01];

% nu = 1; k = 1e-6;
e_us16 = [9.69e-02         3.43e-02        1.17e-02        3.88e-03         1.29e-03];         
e_ps16 = [9.04e+00         3.07e+00        1.14e+00        5.36e-01         2.99e-01];       
e_ud16 = [3.37e-01         1.61e-01        7.82e-02        3.85e-02         1.90e-02];      
e_pd16 = [1.40e+04         3.66e+03        9.45e+02        2.47e+02         6.55e+01];

% nu = 1e-2; k = 1;
e_us21 = [3.17e-02         7.78e-03        1.82e-03        4.20e-04         9.76e-05];         
e_ps21 = [2.45e-01         1.23e-01        6.14e-02        3.07e-02         1.53e-02];       
e_ud21 = [3.15e-01         1.47e-01        7.04e-02        3.42e-02         1.68e-02];       
e_pd21 = [7.38e-02         3.66e-02        1.83e-02        9.12e-03         4.56e-03];

% nu = 1e-2; k = 1e-2;
e_us22 = [8.56e-02         2.85e-02        9.16e-03        2.93e-03         9.26e-04];         
e_ps22 = [2.45e-01         1.23e-01        6.15e-02        3.08e-02         1.54e-02];       
e_ud22 = [3.36e-01         1.60e-01        7.74e-02        3.77e-02         1.84e-02];        
e_pd22 = [1.40e+00         3.64e-01        9.53e-02        2.60e-02         7.91e-03];

% nu = 1e-2; k = 1e-4;
e_us24 = [9.69e-02         3.43e-02        1.17e-02        3.88e-03         1.29e-03];        
e_ps24 = [2.61e-01         1.26e-01        6.24e-02        3.12e-02         1.56e-02];        
e_ud24 = [3.37e-01         1.61e-01        7.82e-02        3.85e-02         1.90e-02];       
e_pd24 = [1.40e+02         3.66e+01        9.45e+00        2.47e+00         6.55e-01];

% nu = 1e-2; k = 1e-6;
e_us26 = [1.00e-01         3.67e-02        1.30e-02        4.46e-03         1.51e-03];         
e_ps26 = [8.91e-01         2.90e-01        9.54e-02        3.71e-02         1.70e-02];        
e_ud26 = [3.37e-01         1.61e-01        7.82e-02        3.85e-02         1.91e-02];      
e_pd26 = [1.41e+04         3.66e+03        9.45e+02        2.47e+02         6.55e+01];

% nu = 1e-4; k = 1;
e_us41 = [8.56e-02         2.85e-02        9.16e-03        2.93e-03         9.26e-04]; 
e_ps41 = [2.45e-01         1.23e-01        6.14e-02        3.07e-02         1.53e-02];        
e_ud41 = [3.36e-01         1.60e-01        7.74e-02        3.77e-02         1.84e-02];        
e_pd41 = [7.40e-02         3.66e-02        1.83e-02        9.12e-03         4.56e-03];

% nu = 1e-4; k = 1e-2;
e_us42 = [9.69e-02         3.43e-02        1.17e-02        3.88e-03         1.29e-03];        
e_ps42 = [2.45e-01         1.23e-01        6.14e-02        3.07e-02         1.53e-02];        
e_ud42 = [3.37e-01         1.61e-01        7.82e-02        3.85e-02         1.90e-02];      
e_pd42 = [1.41e-00         3.67e-01        9.62e-02        2.63e-02         7.98e-03];

% nu = 1e-4; k = 1e-4; 
e_us44 = [1.00e-01        3.67e-02        1.30e-02        4.46e-03         1.51e-03];  
e_ps44 = [2.45e-01        1.23e-01        6.14e-02        3.07e-02         1.53e-02];        
e_ud44 = [3.37e-01        1.61e-01        7.82e-02        3.85e-02         1.91e-02];        
e_pd44 = [1.41e+02        3.66e+01        9.45e+00        2.47e+00         6.55e-01];

% nu = 1e-4; k = 1e-6;
e_us46 = [1.01e-01        3.71e-02        1.33e-02        4.68e-03         1.63e-03];   
e_ps46 = [2.59e-01        1.25e-01        6.18e-02        3.07e-02         1.54e-02];    
e_ud46 = [3.37e-01        1.61e-01        7.82e-02        3.85e-02         1.91e-02];      
e_pd46 = [1.41e+04        3.66e+03        9.45e+02        2.47e+02         6.55e+01];       

% nu = 1e-6; k = 1; 
e_us61 = [9.69e-02        3.43e-02        1.17e-02        3.88e-03         1.29e-03];       
e_ps61 = [2.45e-01        1.23e-01        6.14e-02        3.07e-02         1.53e-02];       
e_ud61 = [3.37e-01        1.61e-01        7.82e-02        3.85e-02         1.90e-02];       
e_pd61 = [7.40e-02        3.66e-02        1.83e-02        9.12e-03         4.56e-03];        

% nu = 1e-6; k = 1e-2
e_us62 = [1.00e-01         3.67e-02        1.30e-02       4.46e-03         1.51e-03];
e_ps62 = [2.45e-01         1.23e-01        6.14e-02       3.07e-02         1.53e-02];       
e_ud62 = [3.37e-01         1.61e-01        7.82e-02       3.85e-02         1.91e-02];        
e_pd62 = [1.41e+00         3.67e-01        9.62e-02       2.63e-02         7.98e-03];        


% nu = 1e-6; k = 1e-4
e_us64 = [1.01e-01         3.71e-02        1.33e-02       4.68e-03         1.63e-03]; 
e_ps64 = [2.45e-01         1.23e-01        6.14e-02       3.07e-02         1.53e-02];       
e_ud64 = [3.37e-01         1.61e-01        7.82e-02       3.85e-02         1.91e-02];        
e_pd64 = [1.41e+02         3.66e+01        9.45e+00       2.47e+00         6.55e-01];        


% nu = 1e-6; k = 1e-6
e_us66 = [1.01e-01         3.72e-02        1.33e-02       4.71e-03         1.66e-03]; 
e_ps66 = [2.45e-01         1.23e-01        6.14e-02       3.07e-02         1.53e-02];      
e_ud66 = [3.37e-01         1.61e-01        7.82e-02       3.85e-02         1.91e-02];       
e_pd66 = [1.41e+04         3.66e+03        9.45e+02       2.47e+02         6.55e+01];

%% us
figure('units','normalized','position',[0.15,0.3,0.75,0.3]);
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
N = log([4,8,16,32,64]);
plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us11_L2 = log(e_us11); plot(N,e_us11_L2,'o-','LineWidth',2); 
e_us12_L2 = log(e_us12); plot(N,e_us12_L2,'o-','LineWidth',2); 
e_us14_L2 = log(e_us14); plot(N,e_us14_L2,'o-','LineWidth',2); 
e_us16_L2 = log(e_us16); plot(N,e_us16_L2,'o-','LineWidth',2); 
title('$\mu = 10^0$','Interpreter','latex','FontSize',20); box on;
ax = gca;
ax.FontSize = 16;

a2 = nexttile; hold on;
plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us21_L2 = log(e_us21); plot(N,e_us21_L2,'o-','LineWidth',2); 
e_us22_L2 = log(e_us22); plot(N,e_us22_L2,'o-','LineWidth',2); 
e_us24_L2 = log(e_us24); plot(N,e_us24_L2,'o-','LineWidth',2); 
e_us26_L2 = log(e_us26); plot(N,e_us26_L2,'o-','LineWidth',2); 
title('$\mu = 10^{-2}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a3 = nexttile; hold on;
plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us41_L2 = log(e_us41); plot(N,e_us41_L2,'o-','LineWidth',2); 
e_us42_L2 = log(e_us42); plot(N,e_us42_L2,'o-','LineWidth',2); 
e_us44_L2 = log(e_us44); plot(N,e_us44_L2,'o-','LineWidth',2); 
e_us46_L2 = log(e_us46); plot(N,e_us46_L2,'o-','LineWidth',2); 
title('$\mu = 10^{-4}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a4 = nexttile; hold on;
plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us61_L2 = log(e_us61); plot(N,e_us61_L2,'o-','LineWidth',2); 
e_us62_L2 = log(e_us62); plot(N,e_us62_L2,'o-','LineWidth',2); 
e_us64_L2 = log(e_us64); plot(N,e_us64_L2,'o-','LineWidth',2); 
e_us66_L2 = log(e_us66); plot(N,e_us66_L2,'o-','LineWidth',2); 
title('$\mu = 10^{-6}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;


linkaxes([a1 a2 a3 a4],'xy')
legend('2-nd order slope','$K = 10^0$','$K = 10^{-2}$','$K = 10^{-4}$', '$K = 10^{-6}$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex','FontSize',18)
xlabel(t,'$1/h$','Interpreter','latex','FontSize',20);
ylabel(t,'$\| \mathbf{u}_S - \mathbf{u}_{S,h} \|_{0}$', 'Interpreter','latex','FontSize',20)

%% ps 
figure('units','normalized','position',[0.15,0.3,0.75,0.3]);
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps11 = log(e_ps11); plot(N,e_ps11,'o-','LineWidth',2); 
e_ps12 = log(e_ps12); plot(N,e_ps12,'o-','LineWidth',2); 
e_ps14 = log(e_ps14); plot(N,e_ps14,'o-','LineWidth',2); 
e_ps16 = log(e_ps16); plot(N,e_ps16,'o-','LineWidth',2); 
%legend('1-nd order slope', 'K = 1e-0','K = 1e-2','K = 1e-4', 'K = 1e-6');
title('$\mu = 10^0$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps21 = log(e_ps21); plot(N,e_ps21,'o-','LineWidth',2); 
e_ps22 = log(e_ps22); plot(N,e_ps22,'o-','LineWidth',2); 
e_ps24 = log(e_ps24); plot(N,e_ps24,'o-','LineWidth',2); 
e_ps26 = log(e_ps26); plot(N,e_ps26,'o-','LineWidth',2); 
%legend('1-nd order slope', 'K = 1e-0','K = 1e-2','K = 1e-4', 'K = 1e-6');
title('$\mu = 10^{-2}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps41 = log(e_ps41); plot(N,e_ps41,'o-','LineWidth',2); 
e_ps42 = log(e_ps42); plot(N,e_ps42,'o-','LineWidth',2); 
e_ps44 = log(e_ps44); plot(N,e_ps44,'o-','LineWidth',2); 
e_ps46 = log(e_ps46); plot(N,e_ps46,'o-','LineWidth',2); 
title('$\mu = 10^{-4}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a4 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps61 = log(e_ps61); plot(N,e_ps61,'o-','LineWidth',2); 
e_ps62 = log(e_ps62); plot(N,e_ps62,'o-','LineWidth',2); 
e_ps64 = log(e_ps64); plot(N,e_ps64,'o-','LineWidth',2); 
e_ps66 = log(e_ps66); plot(N,e_ps66,'o-','LineWidth',2); 
title('$\mu = 10^{-6}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

linkaxes([a1 a2 a3 a4],'xy')
legend('1-st order slope','$K = 10^0$','$K = 10^{-2}$','$K = 10^{-4}$', '$K = 10^{-6}$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex','FontSize',18)
xlabel(t,'$1/h$','Interpreter','latex','FontSize',20)
ylabel(t,'$\| p_S - p_{S,h} \|_{0}$', 'Interpreter','latex','FontSize',20)

%% ud
figure('units','normalized','position',[0.15,0.3,0.75,0.3]);
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud11 = log(e_ud11); plot(N,e_ud11,'o-','LineWidth',2); 
e_ud12 = log(e_ud12); plot(N,e_ud12,'o-','LineWidth',2); 
e_ud14 = log(e_ud14); plot(N,e_ud14,'o-','LineWidth',2); 
e_ud16 = log(e_ud16); plot(N,e_ud16,'o-','LineWidth',2); 
title('$\mu = 10^0$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud21 = log(e_ud21); plot(N,e_ud21,'o-','LineWidth',2); 
e_ud22 = log(e_ud22); plot(N,e_ud22,'o-','LineWidth',2); 
e_ud24 = log(e_ud24); plot(N,e_ud24,'o-','LineWidth',2); 
e_ud26 = log(e_ud26); plot(N,e_ud26,'o-','LineWidth',2); 
title('$\mu = 10^{-2}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud41 = log(e_ud41); plot(N,e_ud41,'o-','LineWidth',2); 
e_ud42 = log(e_ud42); plot(N,e_ud42,'o-','LineWidth',2); 
e_ud44 = log(e_ud44); plot(N,e_ud44,'o-','LineWidth',2); 
e_ud46 = log(e_ud46); plot(N,e_ud46,'o-','LineWidth',2); 
title('$\mu = 10^{-4}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a4 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud61 = log(e_ud61); plot(N,e_ud61,'o-','LineWidth',2); 
e_ud62 = log(e_ud62); plot(N,e_ud62,'o-','LineWidth',2); 
e_ud64 = log(e_ud64); plot(N,e_ud64,'o-','LineWidth',2); 
e_ud66 = log(e_ud66); plot(N,e_ud66,'o-','LineWidth',2); 
title('$\mu = 10^{-6}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

linkaxes([a1 a2 a3 a4],'xy')
legend('1-st order slope','$K = 10^0$','$K = 10^{-2}$','$K = 10^{-4}$', '$K = 10^{-6}$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex','FontSize',18)
xlabel(t,'$1/h$','Interpreter','latex','FontSize',20)
ylabel(t,'$\| \mathbf{u}_D - \mathbf{u}_{D,h} \|_{0}$', 'Interpreter','latex','FontSize',20)


%% pd 
figure('units','normalized','position',[0.15,0.3,0.75,0.3]);
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_pd11 = log(e_pd11); plot(N,e_pd11,'o-','LineWidth',2); 
e_pd12 = log(e_pd12); plot(N,e_pd12,'o-','LineWidth',2); 
e_pd14 = log(e_pd14); plot(N,e_pd14,'o-','LineWidth',2); 
e_pd16 = log(e_pd16); plot(N,e_pd16,'o-','LineWidth',2); 
box on;
title('$\mu = 10^0$','Interpreter','latex','FontSize',18);
ax = gca;
ax.FontSize = 16;

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_pd21 = log(e_pd21); plot(N,e_pd21,'o-','LineWidth',2); 
e_pd22 = log(e_pd22); plot(N,e_pd22,'o-','LineWidth',2); 
e_pd24 = log(e_pd24); plot(N,e_pd24,'o-','LineWidth',2); 
e_pd26 = log(e_pd26); plot(N,e_pd26,'o-','LineWidth',2); 
box on;
title('$\mu = 10^{-2}$','Interpreter','latex','FontSize',18);
ax = gca;
ax.FontSize = 16;

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %1nd order slope
e_pd41 = log(e_pd41); plot(N,e_pd41,'o-','LineWidth',2); 
e_pd42 = log(e_pd42); plot(N,e_pd42,'o-','LineWidth',2); 
e_pd44 = log(e_pd44); plot(N,e_pd44,'o-','LineWidth',2); 
e_pd46 = log(e_pd46); plot(N,e_pd46,'o-','LineWidth',2); 
box on;
title('$\mu = 10^{-4}$','Interpreter','latex','FontSize',18);
ax = gca;
ax.FontSize = 16;

a4 = nexttile; hold on; 
plot(N,-N,'--','LineWidth',2)   %1nd order slope
e_pd61 = log(e_pd61); plot(N,e_pd61,'o-','LineWidth',2); 
e_pd62 = log(e_pd62); plot(N,e_pd62,'o-','LineWidth',2); 
e_pd64 = log(e_pd64); plot(N,e_pd64,'o-','LineWidth',2); 
e_pd66 = log(e_pd66); plot(N,e_pd66,'o-','LineWidth',2); 
box on; 
title('$\mu = 10^{-6}$','Interpreter','latex','FontSize',18);
ax = gca;
ax.FontSize = 16;

linkaxes([a1 a2 a3 a4],'xy')
legend('1-st order slope','$K = 10^0$','$K = 10^{-2}$','$K = 10^{-4}$', '$K = 10^{-6}$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex','FontSize',18)
xlabel(t,'$1/h$','Interpreter','latex','FontSize',20)
ylabel(t,'$\| p_D - p_{D,h} \|_{0}$', 'Interpreter','latex','FontSize',20)
