%% nu = 1; K = 1;
e_us11 = [6.48e-02	 1.90e-02	 5.23e-03	 1.35e-03	 3.42e-04];
e_ps11 = [2.27e+00	 9.93e-01	 4.73e-01	 2.31e-01	 1.14e-01];	 
e_ud11 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02]; 
e_pd11 = [1.45e-01	 7.28e-02	 3.64e-02	 1.82e-02	 9.12e-03];	 

%% nu  =1; K = 1e-2;
e_us12 = [6.54e-02	 1.84e-02	 4.90e-03	 1.25e-03	 3.15e-04];
e_ps12 = [2.26e+00	 9.99e-01	 4.74e-01	 2.31e-01	 1.14e-01];
e_ud12 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02];
e_pd12 = [1.40e+00	 3.40e-01	 8.96e-02	 2.83e-02	 1.06e-02];


%% nu = 1; K = 1e-4;
e_us14 = [6.66e-02	 1.85e-02	 4.93e-03	 1.28e-03	 3.26e-04];
e_ps14 = [2.30e+00	 1.01e+00	 4.76e-01	 2.32e-01	 1.14e-01];
e_ud14 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02]; 
e_pd14 = [1.33e+02	 3.17e+01	 7.81e+00	 1.95e+00	 4.87e-01];	 

%% nu = 1; K = 1e-6;
e_us16 = [6.75e-02	 1.86e-02	 4.98e-03	 1.29e-03	 3.27e-04];
e_ps16 = [2.46e+00	 1.04e+00	 4.81e-01	 2.32e-01	 1.14e-01];	 
e_ud16 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02];	 
e_pd16 = [1.33e+04	 3.16e+03	 7.79e+02	 1.94e+02	 4.85e+01];	 

%% nu = 1e-2; K = 1;
e_us21 = [6.83e-02	 1.88e-02	 4.94e-03	 1.25e-03	 3.15e-04];	 
e_ps21 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud21 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02]; 
e_pd21 = [1.44e-01	 7.28e-02	 3.64e-02	 1.82e-02	 9.12e-03];	

%% nu = 1e-2; K = 1e-2;
e_us22 = [7.41e-02	 2.04e-02	 5.21e-03	 1.31e-03	 3.30e-04];	 
e_ps22 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud22 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02];	 
e_pd22 = [1.36e+00	 3.26e-01	 8.63e-02	 2.67e-02	 1.03e-02];

%% nu = 1e-2; K = 1e-4; 
e_us24 = [6.76e-02	 1.89e-02	 5.13e-03	 1.32e-03	 3.32e-04];	 
e_ps24 = [4.88e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud24 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02];
e_pd24 = [1.33e+02	 3.16e+01	 7.79e+00	 1.94e+00	 4.85e-01];

%% nu = 1e-2; K = 1e-6;
e_us26 = [6.76e-02	 1.87e-02	 5.00e-03	 1.30e-03	 3.30e-04];	 
e_ps26 = [4.88e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud26 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02];	 
e_pd26 = [1.33e+04	 3.16e+03	 7.79e+02	 1.94e+02	 4.85e+01];

%% nu = 1e-4; K = 1;
e_us41 = [8.05e-02	 2.06e-02	 5.22e-03	 1.32e-03	 3.30e-04];
e_ps41 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud41 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02];	 
e_pd41 = [1.44e-01	 7.27e-02	 3.64e-02	 1.82e-02	 9.12e-03];

%% nu = 1e-4; K = 1e-2;	 
e_us42 = [7.65e-02	 2.08e-02	 5.30e-03	 1.33e-03	 3.28e-04]; 
e_ps42 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud42 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02];	 
e_pd42 = [1.36e+00	 3.25e-01	 8.60e-02	 2.66e-02	 1.03e-02];

%% nu = 1e-4; K = 1e-4;	 
e_us44 = [7.08e-02	 1.97e-02	 5.14e-03	 1.30e-03	 3.26e-04];	 
e_ps44 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud44 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02];	 
e_pd44 = [1.33e+02	 3.16e+01	 7.79e+00	 1.94e+00	 4.85e-01];

%% nu = 1e-4; K = 1e-6;	 
e_us46 = [6.55e-02	 1.95e-02	 5.11e-03	 1.29e-03	 3.23e-04];	 
e_ps46 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud46 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02];	 
e_pd46 = [1.33e+04	 3.16e+03	 7.79e+02	 1.94e+02	 4.85e+01];	 


%% nu = 1e-6; K = 1;
e_us61 = [8.25e-02	 2.10e-02	 5.30e-03	 1.33e-03	 3.33e-04];	 
e_ps61 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud61 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02];	 
e_pd61 = [1.44e-01	 7.27e-02	 3.64e-02	 1.82e-02	 9.12e-03];

%% nu = 1e-6; K = 1e-2;
e_us62 = [8.35e-02	 2.10e-02	 5.31e-03	 1.33e-03	 3.34e-04]; 
e_ps62 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud62 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02];	 
e_pd62 = [1.34e+00	 3.24e-01	 8.60e-02	 2.66e-02	 1.03e-02];

%% nu = 1e-6; K = 1e-4;	 
e_us64 = [8.37e-02	 2.11e-02	 5.31e-03	 1.34e-03	 3.35e-04];	 
e_ps64 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02]; 
e_ud64 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02];	 
e_pd64 = [1.33e+02	 3.16e+01	 7.79e+00	 1.94e+00	 4.85e-01];

%% nu = 1e-6; K = 1e-6;	 
e_us66 = [8.37e-02	 2.11e-02	 5.30e-03	 1.23e-03	 2.70e-04];	 
e_ps66 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud66 = [8.18e-01	 4.16e-01	 2.09e-01	 1.05e-01	 5.23e-02];	 
e_pd66 = [1.33e+04	 3.16e+03	 7.79e+02	 1.94e+02	 4.85e+01]; 


%% us
figure('units','normalized','position',[0.15,0.3,0.75,0.3])
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
N = log([4,8,16,32,64]);plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us11 = log(e_us11); plot(N,e_us11,'o-','LineWidth',2); 
e_us12 = log(e_us12); plot(N,e_us12,'o-','LineWidth',2); 
e_us14 = log(e_us14); plot(N,e_us14,'o-','LineWidth',2); 
e_us16 = log(e_us16); plot(N,e_us16,'o-','LineWidth',2); 
title('$\mu = 10^0$','Interpreter','latex','FontSize',18); box on;
ax = gca;  ax.FontSize = 16;

a2 = nexttile; hold on;
plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us21 = log(e_us21); plot(N,e_us21,'o-','LineWidth',2); 
e_us22 = log(e_us22); plot(N,e_us22,'o-','LineWidth',2); 
e_us24 = log(e_us24); plot(N,e_us24,'o-','LineWidth',2); 
e_us26 = log(e_us26); plot(N,e_us26,'o-','LineWidth',2); 
title('$\mu = 10^{-2}$','Interpreter','latex','FontSize',18); box on;
ax = gca;  ax.FontSize = 16;

a3 = nexttile; hold on;
plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us41 = log(e_us41); plot(N,e_us41,'o-','LineWidth',2); 
e_us42 = log(e_us42); plot(N,e_us42,'o-','LineWidth',2); 
e_us44 = log(e_us44); plot(N,e_us44,'o-','LineWidth',2); 
e_us46 = log(e_us46); plot(N,e_us46,'o-','LineWidth',2); 
title('$\mu = 10^{-4}$','Interpreter','latex','FontSize',18); box on;
ax = gca;  ax.FontSize = 16;

a4 = nexttile; hold on;
plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us61 = log(e_us61); plot(N,e_us61,'o-','LineWidth',2); 
e_us62 = log(e_us62); plot(N,e_us62,'o-','LineWidth',2); 
e_us64 = log(e_us64); plot(N,e_us64,'o-','LineWidth',2); 
e_us66 = log(e_us66); plot(N,e_us66,'o-','LineWidth',2); 
title('$\mu = 10^{-6}$','Interpreter','latex','FontSize',18); box on;
ax = gca;  ax.FontSize = 16;

linkaxes([a1 a2 a3 a4],'xy')
legend('2-nd order slope','$K = 10^0$','$K = 10^{-2}$','$K = 10^{-4}$', '$K = 10^{-6}$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex','FontSize',18)
xlabel(t,'$1/h$','Interpreter','latex','FontSize',20)
ylabel(t,'$\| \mathbf{u}_S - \mathbf{u}_{S,h} \|_{0}$', 'Interpreter','latex','FontSize',20)

%% ps 
figure('units','normalized','position',[0.15,0.3,0.75,0.3])
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps11 = log(e_ps11); plot(N,e_ps11,'o-','LineWidth',2); 
e_ps12 = log(e_ps12); plot(N,e_ps12,'o-','LineWidth',2); 
e_ps14 = log(e_ps14); plot(N,e_ps14,'o-','LineWidth',2); 
e_ps16 = log(e_ps16); plot(N,e_ps16,'o-','LineWidth',2); 
%legend('1-nd order slope', 'K = 1e-0','K = 1e-2','K = 1e-4', 'K = 1e-6');
title('$\mu = 10^0$','Interpreter','latex','FontSize',18); box on;
ax = gca;  ax.FontSize = 16;

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps21 = log(e_ps21); plot(N,e_ps21,'o-','LineWidth',2); 
e_ps22 = log(e_ps22); plot(N,e_ps22,'o-','LineWidth',2); 
e_ps24 = log(e_ps24); plot(N,e_ps24,'o-','LineWidth',2); 
e_ps26 = log(e_ps26); plot(N,e_ps26,'o-','LineWidth',2); 
%legend('1-nd order slope', 'K = 1e-0','K = 1e-2','K = 1e-4', 'K = 1e-6');
title('$\mu = 10^{-2}$','Interpreter','latex','FontSize',18); box on;
ax = gca;  ax.FontSize = 16;

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps41 = log(e_ps41); plot(N,e_ps41,'o-','LineWidth',2); 
e_ps42 = log(e_ps42); plot(N,e_ps42,'o-','LineWidth',2); 
e_ps44 = log(e_ps44); plot(N,e_ps44,'o-','LineWidth',2); 
e_ps46 = log(e_ps46); plot(N,e_ps46,'o-','LineWidth',2); 
title('$\mu = 10^{-4}$','Interpreter','latex','FontSize',18); box on;
ax = gca;  ax.FontSize = 16;

a4 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps61 = log(e_ps61); plot(N,e_ps61,'o-','LineWidth',2); 
e_ps62 = log(e_ps62); plot(N,e_ps62,'o-','LineWidth',2); 
e_ps64 = log(e_ps64); plot(N,e_ps64,'o-','LineWidth',2); 
e_ps66 = log(e_ps66); plot(N,e_ps66,'o-','LineWidth',2); 
title('$\mu = 10^{-6}$','Interpreter','latex','FontSize',18); box on;
ax = gca;  ax.FontSize = 16;

linkaxes([a1 a2 a3 a4],'xy')
legend('1-st order slope','$K = 10^0$','$K = 10^{-2}$','$K = 10^{-4}$', '$K = 10^{-6}$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex','FontSize',16)
xlabel(t,'$1/h$','Interpreter','latex','FontSize',20)
ylabel(t,'$\| p_S - p_{S,h} \|_{0}$', 'Interpreter','latex','FontSize',20)

%% ud
figure('units','normalized','position',[0.15,0.3,0.75,0.3])
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud11 = log(e_ud11); plot(N,e_ud11,'o-','LineWidth',2); 
e_ud12 = log(e_ud12); plot(N,e_ud12,'o-','LineWidth',2); 
e_ud14 = log(e_ud14); plot(N,e_ud14,'o-','LineWidth',2); 
e_ud16 = log(e_ud16); plot(N,e_ud16,'o-','LineWidth',2); 
title('$\mu = 10^0$','Interpreter','latex','FontSize',18); box on;
ax = gca;  ax.FontSize = 16;

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud21 = log(e_ud21); plot(N,e_ud21,'o-','LineWidth',2); 
e_ud22 = log(e_ud22); plot(N,e_ud22,'o-','LineWidth',2); 
e_ud24 = log(e_ud24); plot(N,e_ud24,'o-','LineWidth',2); 
e_ud26 = log(e_ud26); plot(N,e_ud26,'o-','LineWidth',2); 
title('$\mu = 10^{-2}$','Interpreter','latex','FontSize',18); box on;
ax = gca;  ax.FontSize = 16;

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud41 = log(e_ud41); plot(N,e_ud41,'o-','LineWidth',2); 
e_ud42 = log(e_ud42); plot(N,e_ud42,'o-','LineWidth',2); 
e_ud44 = log(e_ud44); plot(N,e_ud44,'o-','LineWidth',2); 
e_ud46 = log(e_ud46); plot(N,e_ud46,'o-','LineWidth',2); 
title('$\mu = 10^{-4}$','Interpreter','latex','FontSize',18); box on;
ax = gca;  ax.FontSize = 16;

a4 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud61 = log(e_ud61); plot(N,e_ud61,'o-','LineWidth',2); 
e_ud62 = log(e_ud62); plot(N,e_ud62,'o-','LineWidth',2); 
e_ud64 = log(e_ud64); plot(N,e_ud64,'o-','LineWidth',2); 
e_ud66 = log(e_ud66); plot(N,e_ud66,'o-','LineWidth',2); 
title('$\mu = 10^{-6}$','Interpreter','latex','FontSize',18); box on;
ax = gca;  ax.FontSize = 16;

linkaxes([a1 a2 a3 a4],'xy')
legend('1-st order slope','$K = 10^0$','$K = 10^{-2}$','$K = 10^{-4}$', '$K = 10^{-6}$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex','FontSize',18)
xlabel(t,'$1/h$','Interpreter','latex','FontSize',20)
ylabel(t,'$\| \mathbf{u}_D - \mathbf{u}_{D,h} \|_{0}$', 'Interpreter','latex','FontSize',20)


%% pd 
figure('units','normalized','position',[0.15,0.3,0.75,0.3])
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_pd11 = log(e_pd11); plot(N,e_pd11,'o-','LineWidth',2); 
e_pd12 = log(e_pd12); plot(N,e_pd12,'o-','LineWidth',2); 
e_pd14 = log(e_pd14); plot(N,e_pd14,'o-','LineWidth',2); 
e_pd16 = log(e_pd16); plot(N,e_pd16,'o-','LineWidth',2); 
box on;
title('$\mu = 10^0$','Interpreter','latex','FontSize',18);
ax = gca;  ax.FontSize = 16;

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_pd21 = log(e_pd21); plot(N,e_pd21,'o-','LineWidth',2); 
e_pd22 = log(e_pd22); plot(N,e_pd22,'o-','LineWidth',2); 
e_pd24 = log(e_pd24); plot(N,e_pd24,'o-','LineWidth',2); 
e_pd26 = log(e_pd26); plot(N,e_pd26,'o-','LineWidth',2); 
box on;
title('$\mu = 10^{-2}$','Interpreter','latex','FontSize',18);
ax = gca;  ax.FontSize = 16;

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %1nd order slope
e_pd41 = log(e_pd41); plot(N,e_pd41,'o-','LineWidth',2); 
e_pd42 = log(e_pd42); plot(N,e_pd42,'o-','LineWidth',2); 
e_pd44 = log(e_pd44); plot(N,e_pd44,'o-','LineWidth',2); 
e_pd46 = log(e_pd46); plot(N,e_pd46,'o-','LineWidth',2); 
box on;
title('$\mu = 10^{-4}$','Interpreter','latex','FontSize',18);
ax = gca;  ax.FontSize = 16;

a4 = nexttile; hold on; 
plot(N,-N,'--','LineWidth',2)   %1nd order slope
e_pd61 = log(e_pd61); plot(N,e_pd61,'o-','LineWidth',2); 
e_pd62 = log(e_pd62); plot(N,e_pd62,'o-','LineWidth',2); 
e_pd64 = log(e_pd64); plot(N,e_pd64,'o-','LineWidth',2); 
e_pd66 = log(e_pd66); plot(N,e_pd66,'o-','LineWidth',2); 
box on; 
title('$\mu = 10^{-6}$','Interpreter','latex','FontSize',18);
ax = gca;  ax.FontSize = 16;

linkaxes([a1 a2 a3 a4],'xy')
legend('1-st order slope','$K = 10^0$','$K = 10^{-2}$','$K = 10^{-4}$', '$K = 10^{-6}$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex','FontSize',18)
xlabel(t,'$1/h$','Interpreter','latex','FontSize',20)
ylabel(t,'$\| p_D - p_{D,h} \|_{0}$', 'Interpreter','latex','FontSize',20)
