
%% nu = 1; K = 1;
e_us11 = [1.10e+00	 5.79e-01	 2.96e-01	 1.48e-01	 7.40e-02];	 
e_ps11 = [6.53e-01	 3.29e-01	 1.58e-01	 7.61e-02	 3.73e-02]; 
e_ud11 = [4.82e-01	 2.38e-01	 1.19e-01	 5.92e-02	 2.95e-02];	 
e_pd11 = [1.49e-01	 7.37e-02	 3.66e-02	 1.83e-02	 9.12e-03];

%% nu = 1; K = 1e-2;	 
e_us12 = [7.31e-01	 3.54e-01	 1.74e-01	 8.60e-02	 4.26e-02];	 
e_ps12 = [9.03e-01	 4.12e-01	 1.96e-01	 9.60e-02	 4.74e-02];	 
e_ud12 = [4.81e-01	 2.38e-01	 1.19e-01	 5.92e-02	 2.95e-02]; 
e_pd12 = [4.03e+00	 1.21e+00	 3.28e-01	 8.81e-02	 2.54e-02];

%% nu = 1; K = 1e-4; 
e_us14 = [1.29e+00	 8.63e-01	 4.90e-01	 2.51e-01	 1.21e-01];	 
e_ps14 = [9.45e+00	 5.49e+00	 2.74e+00	 1.32e+00	 6.47e-01];	 
e_ud14 = [4.85e-01	 2.40e-01	 1.20e-01	 5.97e-02	 2.97e-02]; 
e_pd14 = [4.06e+02	 1.19e+02	 3.16e+01	 8.26e+00	 2.45e+00];

%% nu = 1; K = 1e-6;	 
e_us16 = [2.48e+00	 2.32e+00	 1.63e+00	 9.97e-01	 5.59e-01]; 
e_ps16 = [9.45e+01	 5.60e+01	 3.13e+01	 1.55e+01	 9.29e+00];	 
e_ud16 = [4.86e-01	 2.41e-01	 1.21e-01	 6.06e-02	 3.03e-02];	 
e_pd16 = [4.06e+04	 1.19e+04	 3.12e+03	 7.97e+02	 2.21e+02];

%% nu = 1e-2; K = 1;
e_us21 = [1.10e+00	 5.79e-01	 2.96e-01	 1.48e-01    7.40e-02];	 
e_ps21 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud21 = [4.82e-01	 2.38e-01	 1.19e-01	 5.92e-02	 2.95e-02];	 
e_pd21 = [1.44e-01	 7.27e-02	 3.64e-02	 1.82e-02	 9.12e-03];

%% nu = 1e-2; K = 1e-2;	 
e_us22 = [7.31e-01	 3.54e-01	 1.74e-01	 8.60e-02	 4.26e-02];	 
e_ps22 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud22 = [4.81e-01	 2.38e-01	 1.19e-01	 5.92e-02	 2.95e-02];	 
e_pd22 = [1.49e-01	 7.37e-02	 3.66e-02	 1.83e-02	 9.12e-03];

%% nu = 1e-2; K = 1e-4;	 
e_us24 = [1.29e+00	 8.63e-01	 4.90e-01	 2.51e-01	 1.21e-01];	 
e_ps24 = [4.96e-01	 2.51e-01	 1.26e-01	 6.28e-02	 3.14e-02];	 
e_ud24 = [4.85e-01	 2.40e-01	 1.20e-01	 5.97e-02	 2.97e-02];	 
e_pd24 = [4.06e+00	 1.19e+00	 3.18e-01	 8.45e-02	 2.61e-02];

%% nu = 1e-2; K = 1e-6;	 
e_us26 = [2.48e+00	 2.31e+00	 1.63e+00	 9.97e-01	 5.59e-01];	 
e_ps26 = [1.06e+00	 6.10e-01	 3.36e-01	 1.67e-01	 9.77e-02];	 
e_ud26 = [4.86e-01	 2.41e-01	 1.21e-01	 6.06e-02	 3.03e-02];	 
e_pd26 = [4.06e+02	 1.19e+02	 3.12e+01	 7.97e+00	 2.20e+00];

%% nu = 1e-4; K = 1;
e_us41 = [1.10e+00	 5.79e-01	 2.96e-01	 1.48e-01	 7.40e-02];	 
e_ps41 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud41 = [4.82e-01	 2.38e-01	 1.19e-01	 5.92e-02	 2.95e-02];	 
e_pd41 = [1.44e-01	 7.27e-02	 3.64e-02	 1.82e-02	 9.12e-03];

%% nu = 1e-4; K = 1e-2;	 
e_us42 = [7.31e-01	 3.54e-01	 1.74e-01	 8.60e-02	 4.25e-02];	 
e_ps42 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud42 = [4.81e-01	 2.38e-01	 1.19e-01	 5.92e-02	 2.95e-02];	 
e_pd42 = [1.44e-01	 7.27e-02	 3.64e-02	 1.82e-02	 9.12e-03];

%% nu = 1e-4; K = 1e-4;	 
e_us44 = [1.29e+00	 8.63e-01	 4.90e-01	 2.51e-01	 1.21e-01];	 
e_ps44 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud44 = [4.85e-01	 2.40e-01	 1.20e-01	 5.97e-02	 2.97e-02];	 
e_pd44 = [1.49e-01	 7.36e-02	 3.66e-02	 1.82e-02	 9.12e-03];

%% nu = 1e-4; K = 1e-6; 
e_us46 = [2.47e+00	 2.31e+00	 1.63e+00	 1.00e+00	 5.56e-01];	 
e_ps46 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud46 = [4.86e-01	 2.41e-01	 1.21e-01	 6.06e-02	 3.03e-02];	 
e_pd46 = [4.07e+00	 1.19e+00	 3.14e-01	 8.17e-02	 2.21e-02];

%% nu = 1e-6; K = 1;
e_us61 = [1.07e+00	 5.79e-01	 2.96e-01	 1.48e-01	 7.40e-02];	 
e_ps61 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud61 = [5.81e-01	 2.38e-01	 1.19e-01	 5.92e-02	 2.95e-02];	 
e_pd61 = [1.44e-01	 7.27e-02	 3.64e-02	 1.82e-02	 9.12e-03];

%% nu = 1e-6; K = 1e-2;	 
e_us62 = [7.34e-01	 3.54e-01	 1.74e-01	 8.60e-02	 4.26e-02];	 
e_ps62 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud62 = [4.81e-01	 2.38e-01	 1.19e-01	 5.92e-02	 2.95e-02];	 
e_pd62 = [1.44e-01	 7.27e-02	 3.64e-02	 1.82e-02	 9.12e-03];

%% nu = 1e-6; K = 1e-4;	 
e_us64 = [1.29e+00	 8.63e-01	 4.90e-01	 2.51e-01	 1.21e-01];	 
e_ps64 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud64 = [4.85e-01	 2.40e-01	 1.20e-01	 5.97e-02	 2.97e-02];	 
e_pd64 = [1.44e-01	 7.27e-02	 3.64e-02	 1.82e-02	 9.12e-03];

%% nu = 1e-6; K = 1e-6;	 
e_us66 = [2.48e+00	 2.32e+00	 1.63e+00	 9.97e-01	 5.54e-01];	 
e_ps66 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud66 = [4.86e-01	 2.41e-01	 1.21e-01	 6.06e-02	 3.03e-02];	 
e_pd66 = [1.49e-01	 7.36e-02	 3.66e-02	 1.82e-02	 9.12e-03];	 

%% us
figure;
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
N = log([4,8,16,32,64]);plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_us11 = log(e_us11); plot(N,e_us11,'o-','LineWidth',2); 
e_us12 = log(e_us12); plot(N,e_us12,'o-','LineWidth',2); 
e_us14 = log(e_us14); plot(N,e_us14,'o-','LineWidth',2); 
e_us16 = log(e_us16); plot(N,e_us16,'o-','LineWidth',2); 
title('$\mu = 1$','Interpreter','latex'); box on;

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_us21 = log(e_us21); plot(N,e_us21,'o-','LineWidth',2); 
e_us22 = log(e_us22); plot(N,e_us22,'o-','LineWidth',2); 
e_us24 = log(e_us24); plot(N,e_us24,'o-','LineWidth',2); 
e_us26 = log(e_us26); plot(N,e_us26,'o-','LineWidth',2); 
title('$\mu = 1e-2$','Interpreter','latex'); box on;

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_us41 = log(e_us41); plot(N,e_us41,'o-','LineWidth',2); 
e_us42 = log(e_us42); plot(N,e_us42,'o-','LineWidth',2); 
e_us44 = log(e_us44); plot(N,e_us44,'o-','LineWidth',2); 
e_us46 = log(e_us46); plot(N,e_us46,'o-','LineWidth',2); 
title('$\mu = 1e-4$','Interpreter','latex'); box on;

a4 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_us61 = log(e_us61); plot(N,e_us61,'o-','LineWidth',2); 
e_us62 = log(e_us62); plot(N,e_us62,'o-','LineWidth',2); 
e_us64 = log(e_us64); plot(N,e_us64,'o-','LineWidth',2); 
e_us66 = log(e_us66); plot(N,e_us66,'o-','LineWidth',2); 
title('$\mu = 1e-6$','Interpreter','latex'); box on;

linkaxes([a1 a2 a3 a4],'xy')
legend('1-nd order slope','$k = 1e-0$','$k = 1e-2$','$k = 1e-4$', '$k = 1e-6$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex')
xlabel(t,'Mesh Size')
ylabel(t,'$\| \mathbf{u}_S - \mathbf{u}_{S,h} \|_{1}$', 'Interpreter','latex')

%% ps 
figure;
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps11 = log(e_ps11); plot(N,e_ps11,'o-','LineWidth',2); 
e_ps12 = log(e_ps12); plot(N,e_ps12,'o-','LineWidth',2); 
e_ps14 = log(e_ps14); plot(N,e_ps14,'o-','LineWidth',2); 
e_ps16 = log(e_ps16); plot(N,e_ps16,'o-','LineWidth',2); 
%legend('1-nd order slope', 'K = 1e-0','K = 1e-2','K = 1e-4', 'K = 1e-6');
title('$\mu = 1$','Interpreter','latex'); box on;

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps21 = log(e_ps21); plot(N,e_ps21,'o-','LineWidth',2); 
e_ps22 = log(e_ps22); plot(N,e_ps22,'o-','LineWidth',2); 
e_ps24 = log(e_ps24); plot(N,e_ps24,'o-','LineWidth',2); 
e_ps26 = log(e_ps26); plot(N,e_ps26,'o-','LineWidth',2); 
%legend('1-nd order slope', 'K = 1e-0','K = 1e-2','K = 1e-4', 'K = 1e-6');
title('$\mu = 1e-2$','Interpreter','latex'); box on;

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps41 = log(e_ps41); plot(N,e_ps41,'o-','LineWidth',2); 
e_ps42 = log(e_ps42); plot(N,e_ps42,'o-','LineWidth',2); 
e_ps44 = log(e_ps44); plot(N,e_ps44,'o-','LineWidth',2); 
e_ps46 = log(e_ps46); plot(N,e_ps46,'o-','LineWidth',2); 
title('$\mu = 1e-4$','Interpreter','latex'); box on;

a4 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps61 = log(e_ps61); plot(N,e_ps61,'o-','LineWidth',2); 
e_ps62 = log(e_ps62); plot(N,e_ps62,'o-','LineWidth',2); 
e_ps64 = log(e_ps64); plot(N,e_ps64,'o-','LineWidth',2); 
e_ps66 = log(e_ps66); plot(N,e_ps66,'o-','LineWidth',2); 
title('$\mu = 1e-6$','Interpreter','latex'); box on;

linkaxes([a1 a2 a3 a4],'xy')
legend('1-nd order slope','$k = 1e-0$','$k = 1e-2$','$k = 1e-4$', '$k = 1e-6$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex')
xlabel(t,'Mesh size')
ylabel(t,'$\| p_S - p_{S,h} \|_{0}$', 'Interpreter','latex')

%% ud
figure;
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud11 = log(e_ud11); plot(N,e_ud11,'o-','LineWidth',2); 
e_ud12 = log(e_ud12); plot(N,e_ud12,'o-','LineWidth',2); 
e_ud14 = log(e_ud14); plot(N,e_ud14,'o-','LineWidth',2); 
e_ud16 = log(e_ud16); plot(N,e_ud16,'o-','LineWidth',2); 
title('$\mu = 1$','Interpreter','latex'); box on;

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud21 = log(e_ud21); plot(N,e_ud21,'o-','LineWidth',2); 
e_ud22 = log(e_ud22); plot(N,e_ud22,'o-','LineWidth',2); 
e_ud24 = log(e_ud24); plot(N,e_ud24,'o-','LineWidth',2); 
e_ud26 = log(e_ud26); plot(N,e_ud26,'o-','LineWidth',2); 
title('$\mu = 1e-2$','Interpreter','latex'); box on;

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud41 = log(e_ud41); plot(N,e_ud41,'o-','LineWidth',2); 
e_ud42 = log(e_ud42); plot(N,e_ud42,'o-','LineWidth',2); 
e_ud44 = log(e_ud44); plot(N,e_ud44,'o-','LineWidth',2); 
e_ud46 = log(e_ud46); plot(N,e_ud46,'o-','LineWidth',2); 
title('$\mu = 1e-4$','Interpreter','latex'); box on;

a4 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud61 = log(e_ud61); plot(N,e_ud61,'o-','LineWidth',2); 
e_ud62 = log(e_ud62); plot(N,e_ud62,'o-','LineWidth',2); 
e_ud64 = log(e_ud64); plot(N,e_ud64,'o-','LineWidth',2); 
e_ud66 = log(e_ud66); plot(N,e_ud66,'o-','LineWidth',2); 
title('$\mu = 1e-6$','Interpreter','latex'); box on;

linkaxes([a1 a2 a3 a4],'xy')
legend('1-nd order slope','$k = 1e-0$','$k = 1e-2$','$k = 1e-4$', '$k = 1e-6$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex')
xlabel(t,'Mesh Size')
ylabel(t,'$\| \mathbf{u}_D - \mathbf{u}_{D,h} \|_{0}$', 'Interpreter','latex')


%% pd 
figure;
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_pd11 = log(e_pd11); plot(N,e_pd11,'o-','LineWidth',2); 
e_pd12 = log(e_pd12); plot(N,e_pd12,'o-','LineWidth',2); 
e_pd14 = log(e_pd14); plot(N,e_pd14,'o-','LineWidth',2); 
e_pd16 = log(e_pd16); plot(N,e_pd16,'o-','LineWidth',2); 
box on;
title('$\mu = 1$','Interpreter','latex');

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_pd21 = log(e_pd21); plot(N,e_pd21,'o-','LineWidth',2); 
e_pd22 = log(e_pd22); plot(N,e_pd22,'o-','LineWidth',2); 
e_pd24 = log(e_pd24); plot(N,e_pd24,'o-','LineWidth',2); 
e_pd26 = log(e_pd26); plot(N,e_pd26,'o-','LineWidth',2); 
box on;
title('$\mu = 1e-2$','Interpreter','latex');

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %1nd order slope
e_pd41 = log(e_pd41); plot(N,e_pd41,'o-','LineWidth',2); 
e_pd42 = log(e_pd42); plot(N,e_pd42,'o-','LineWidth',2); 
e_pd44 = log(e_pd44); plot(N,e_pd44,'o-','LineWidth',2); 
e_pd46 = log(e_pd46); plot(N,e_pd46,'o-','LineWidth',2); 
box on;
title('$\mu = 1e-4$','Interpreter','latex');

a4 = nexttile; hold on; 
plot(N,-N,'--','LineWidth',2)   %1nd order slope
e_pd61 = log(e_pd61); plot(N,e_pd61,'o-','LineWidth',2); 
e_pd62 = log(e_pd62); plot(N,e_pd62,'o-','LineWidth',2); 
e_pd64 = log(e_pd64); plot(N,e_pd64,'o-','LineWidth',2); 
e_pd66 = log(e_pd66); plot(N,e_pd66,'o-','LineWidth',2); 
box on; 
title('$\mu = 1e-6$','Interpreter','latex');

linkaxes([a1 a2 a3 a4],'xy')
legend('1-nd order slope','$k = 1e-0$','$k = 1e-2$','$k = 1e-4$', '$k = 1e-6$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex')
xlabel(t,'Mesh Size')
ylabel(t,'$\| p_D - p_{D,h} \|_{0}$', 'Interpreter','latex')
