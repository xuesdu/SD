
%% nu = 1; K = 1;
e_us11 = [1.10e+00	 5.80e-01	 2.96e-01	 1.48e-01	 7.40e-02];	 % H1-norm
e_us11_L2 = [7.58e-02 2.10e-02   5.56e-03    1.41e-03    3.54e-04];  % L2-norm
e_ps11 = [6.51e-01	 3.28e-01	 1.58e-01	 7.60e-02	 3.73e-02]; 
e_ud11 = [7.11e-01	 3.33e-01	 1.58e-01	 7.65e-02	 3.74e-02];	 
e_pd11 = [1.53e-01	 7.41e-02	 3.66e-02	 1.83e-02	 9.12e-03];

%% nu = 1; K = 1e-2;	 
e_us12 = [1.15e+00	 6.08e-01	 3.09e-01	 1.54e-01	 7.61e-02];	 
e_us12_L2 = [8.37e-02 2.29e-02   5.96e-03    1.50e-03    3.69e-04];
e_ps12 = [7.45e-01	 3.61e-01	 1.70e-01	 8.09e-02	 3.91e-02];	 
e_ud12 = [7.13e-01	 3.34e-01	 1.59e-01	 7.66e-02	 3.74e-02]; 
e_pd12 = [5.20e+00	 1.44e+00	 3.73e-01	 9.76e-02	 2.71e-02];

%% nu = 1; K = 1e-4; 
e_us14 = [1.37e+00	 9.31e-01	 6.52e-01	 4.39e-01	 2.86e-01];	 
e_us14_L2 = [1.08e-01 4.01e-02   1.46e-02    4.99e-03    1.64e-03];
e_ps14 = [1.31e+00	 8.51e-01	 5.72e-01	 3.62e-01	 2.22e-01];	 
e_ud14 = [7.17e-01	 3.37e-01	 1.61e-01	 7.79e-02	 3.82e-02]; 
e_pd14 = [5.29e+02	 1.45e+02	 3.75e+01	 9.62e+00	 2.50e+00];

%% nu = 1; K = 1e-6;	 
e_us16 = [1.50e+00	 1.08e+00	 8.05e-01	 5.69e-01	 3.90e-01]; 
e_us16_L2 = [1.18e-01 4.51e-02   1.73e-02    6.23e-03    2.17e-03];
e_ps16 = [1.60e+00	 1.21e+00	 9.02e-01	 6.08e-01	 3.88e-01];	 
e_ud16 = [7.17e-01	 3.37e-01	 1.61e-01	 7.82e-02	 3.85e-02];	 
e_pd16 = [5.29e+04	 1.46e+04	 3.75e+03	 9.64e+02	 2.51e+02];

%% nu = 1e-2; K = 1;
e_us21 = [1.15e+00	 6.08e-01	 3.09e-01	 1.54e-01	 7.61e-02];	 
e_us21_L2 = [8.37e-02  2.29e-02  5.96e-03	 1.50e-03 	 3.69e-04];	 
e_ps21 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud21 = [7.13e-01	 3.34e-01	 1.59e-01	 7.66e-02	 3.74e-02];	 
e_pd21 = [1.53e-01	 7.41e-02	 3.66e-02	 1.83e-02	 9.12e-03];

%% nu = 1e-2; K = 1e-2;	 
e_us22 = [1.37e+00	 9.31e-01	 6.52e-01	 4.39e-01	 2.86e-01];	 
e_us22_L2 = [1.08e-01	4.01e-02 1.46e-02	 4.99e-03 	 1.64e-03];	 
e_ps22 = [4.87e-01	 2.45e-01	 1.23e-01	 6.15e-02	 3.08e-02];	 
e_ud22 = [7.17e-01	 3.37e-01	 1.61e-01	 7.79e-02	 3.82e-02];	 
e_pd22 = [5.29e+00	 1.46e+00	 3.77e-01	 9.79e-02	 2.66e-02];

%% nu = 1e-2; K = 1e-4;	 
e_us24 = [1.50e+00	 1.08e+00	 8.05e-01	 5.69e-01	 3.90e-01];
e_us24_L2 = [1.18e-01	4.51e-02 1.73e-02	 6.23e-03 	 2.17e-03];	 
e_ps24 = [4.87e-01	 2.45e-01	 1.23e-01	 6.17e-02	 3.09e-02];	 
e_ud24 = [7.17e-01	 3.37e-01	 1.61e-01	 7.82e-02	 3.85e-02];	 
e_pd24 = [5.29e+02	 1.46e+02	 3.75e+01	 9.64e+00	 2.51e+00];

%% nu = 1e-2; K = 1e-6;	 
e_us26 = [1.54e+00	 1.13e+00	 8.84e-01	 6.56e-01	 4.67e-01];	
e_us26_L2 = [1.20e-01	4.67e-02 1.85e-02	 6.90e-03 	 2.47e-03];	 
e_ps26 = [4.87e-01	 2.45e-01	 1.23e-01	 6.19e-02	 3.12e-02];	 
e_ud26 = [7.17e-01	 3.37e-01	 1.61e-01	 7.82e-02	 3.85e-02];	 
e_pd26 = [5.29e+04	 1.46e+04	 3.75e+03	 9.64e+02	 2.51e+02];

%% nu = 1e-4; K = 1;
e_us41 = [1.37e+00	 9.31e-01	 6.52e-01	 4.39e-01	 2.86e-01];	 
e_us41_L2 = [1.08e-01	 4.01e-02	 1.46e-02	 4.99e-03	 1.64e-03];	 
e_ps41 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud41 = [7.17e-01	 3.37e-01	 1.61e-01	 7.79e-02	 3.82e-02];	 
e_pd41 = [1.53e-01	 7.41e-02	 3.66e-02	 1.83e-02	 9.12e-03];

%% nu = 1e-4; K = 1e-2;	 
e_us42 = [1.50e+00	 1.08e+00	 8.05e-01	 5.69e-01	 3.90e-01];	 
e_us42_L2 = [1.18e-01	 4.51e-02	 1.73e-02	 6.23e-03	 2.17e-03];	 
e_ps42 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud42 = [7.17e-01	 3.37e-01	 1.61e-01	 7.82e-02	 3.85e-02];	 
e_pd42 = [5.29e+00	 1.46e+00	 3.77e-01	 9.81e-02	 2.67e-02];

%% nu = 1e-4; K = 1e-4;	 
e_us44 = [1.54e+00	 1.13e+00	 8.84e-01	 6.56e-01	 4.67e-01];	 
e_us44_L2 = [1.20e-01	 4.67e-02 1.85e-02   6.91e-03	 2.47e-03];	 
e_ps44 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud44 = [7.17e-01	 3.37e-01	 1.61e-01	 7.82e-02	 3.85e-02];	 
e_pd44 = [5.29e+02	 1.46e+02	 3.75e+01	 9.64e+00	 2.51e+00];

%% nu = 1e-4; K = 1e-6; 
e_us46 = [1.54e+00	 1.14e+00	 8.97e-01	 6.75e-01	 4.93e-01];	 
e_us46_L2 = [1.20e-01	 4.70e-02 1.87e-02   7.05e-03	 2.57e-03];	 
e_ps46 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud46 = [7.17e-01	 3.37e-01	 1.61e-01	 7.82e-02	 3.85e-02];	 
e_pd46 = [5.29e+04	 1.46e+04	 3.75e+03	 9.64e+02	 2.51e+02];

%% nu = 1e-6; K = 1;
e_us61 = [1.50e+00	 1.08e+00	 8.05e-01	 5.69e-01	 3.90e-01];	 
e_us61_L2 = [1.17e-01	4.51e-02	 1.73e-02	 6.23e-03	 2.17e-03];	 
e_ps61 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud61 = [7.17e-01	 3.37e-01	 1.61e-01	 7.82e-02	 3.85e-02];	 
e_pd61 = [1.53e-01	 7.41e-02	 3.66e-02	 1.83e-02	 9.12e-03];

%% nu = 1e-6; K = 1e-2;	 
e_us62 = [1.53e+00	 1.14e+00	 8.85e-01	 6.57e-01	 4.68e-01];	 
e_us62_L2 = [1.19e-01	4.68e-02	 1.86e-02	 6.95e-03	 2.55e-03];
e_ps62 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud62 = [7.17e-01	 3.37e-01	 1.61e-01	 7.82e-02	 3.85e-02];	 
e_pd62 = [5.29e+00	 1.46e+00	 3.77e-01	 9.85e-02	 2.71e-02];

%% nu = 1e-6; K = 1e-4;	 
e_us64 = [1.55e+00	 1.15e+00	 9.02e-01	 6.79e-01	 4.96e-01];	 
e_us64_L2 = [1.12e-01	4.54e-02	 1.85e-02	 7.01e-03	 2.56e-03];
e_ps64 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud64 = [7.17e-01	 3.37e-01	 1.61e-01	 7.82e-02	 3.85e-02];	 
e_pd64 = [5.29e+02	 1.46e+02	 3.75e+01	 9.64e+00	 2.51e+00];

%% nu = 1e-6; K = 1e-6;	 
e_us66 = [1.55e+00	 1.15e+00	 9.03e-01	 6.81e-01	 4.99e-01];	 
e_us66_L2 = [1.12e-01	4.54e-02	 1.85e-02	 7.02e-03	 2.57e-03];
e_ps66 = [4.87e-01	 2.45e-01	 1.23e-01	 6.14e-02	 3.07e-02];	 
e_ud66 = [7.17e-01	 3.37e-01	 1.61e-01	 7.82e-02	 3.85e-02];	 
e_pd66 = [5.29e+04	 1.46e+04	 3.75e+03	 9.64e+02	 2.51e+02];	 

%% us
figure('units','normalized','position',[0.15,0.3,0.75,0.3]);
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
N = log([4,8,16,32,64]);
plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us11_L2 = log(e_us11_L2); plot(N,e_us11_L2,'o-','LineWidth',2); 
e_us12_L2 = log(e_us12_L2); plot(N,e_us12_L2,'o-','LineWidth',2); 
e_us14_L2 = log(e_us14_L2); plot(N,e_us14_L2,'o-','LineWidth',2); 
e_us16_L2 = log(e_us16_L2); plot(N,e_us16_L2,'o-','LineWidth',2); 
title('$\mu = 10^0$','Interpreter','latex','FontSize',20); box on;
ax = gca;
ax.FontSize = 16;

a2 = nexttile; hold on;
plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us21_L2 = log(e_us21_L2); plot(N,e_us21_L2,'o-','LineWidth',2); 
e_us22_L2 = log(e_us22_L2); plot(N,e_us22_L2,'o-','LineWidth',2); 
e_us24_L2 = log(e_us24_L2); plot(N,e_us24_L2,'o-','LineWidth',2); 
e_us26_L2 = log(e_us26_L2); plot(N,e_us26_L2,'o-','LineWidth',2); 
title('$\mu = 10^{-2}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a3 = nexttile; hold on;
plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us41_L2 = log(e_us41_L2); plot(N,e_us41_L2,'o-','LineWidth',2); 
e_us42_L2 = log(e_us42_L2); plot(N,e_us42_L2,'o-','LineWidth',2); 
e_us44_L2 = log(e_us44_L2); plot(N,e_us44_L2,'o-','LineWidth',2); 
e_us46_L2 = log(e_us46_L2); plot(N,e_us46_L2,'o-','LineWidth',2); 
title('$\mu = 10^{-4}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a4 = nexttile; hold on;
plot(N,-2*N,'--','LineWidth',2)   %2nd order slope
e_us61_L2 = log(e_us61_L2); plot(N,e_us61_L2,'o-','LineWidth',2); 
e_us62_L2 = log(e_us62_L2); plot(N,e_us62_L2,'o-','LineWidth',2); 
e_us64_L2 = log(e_us64_L2); plot(N,e_us64_L2,'o-','LineWidth',2); 
e_us66_L2 = log(e_us66_L2); plot(N,e_us66_L2,'o-','LineWidth',2); 
title('$\mu = 10^{-6}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;


linkaxes([a1 a2 a3 a4],'xy')
legend('2-nd order slope','$K = 10^0$','$K = 10^{-2}$','$K = 10^{-4}$', '$K = 10^{-6}$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex','FontSize',18)
xlabel(t,'$1/h$','Interpreter','latex','FontSize',20);
ylabel(t,'$\| \mathbf{u}_S - \mathbf{u}_{S,h} \|_{0}$', 'Interpreter','latex','FontSize',20)

%% ps 
figure('units','normalized','position',[0.15,0.3,0.75,0.3]);
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps11 = log(e_ps11); plot(N,e_ps11,'o-','LineWidth',2); 
e_ps12 = log(e_ps12); plot(N,e_ps12,'o-','LineWidth',2); 
e_ps14 = log(e_ps14); plot(N,e_ps14,'o-','LineWidth',2); 
e_ps16 = log(e_ps16); plot(N,e_ps16,'o-','LineWidth',2); 
%legend('1-nd order slope', 'K = 1e-0','K = 1e-2','K = 1e-4', 'K = 1e-6');
title('$\mu = 10^0$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps21 = log(e_ps21); plot(N,e_ps21,'o-','LineWidth',2); 
e_ps22 = log(e_ps22); plot(N,e_ps22,'o-','LineWidth',2); 
e_ps24 = log(e_ps24); plot(N,e_ps24,'o-','LineWidth',2); 
e_ps26 = log(e_ps26); plot(N,e_ps26,'o-','LineWidth',2); 
%legend('1-nd order slope', 'K = 1e-0','K = 1e-2','K = 1e-4', 'K = 1e-6');
title('$\mu = 10^{-2}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps41 = log(e_ps41); plot(N,e_ps41,'o-','LineWidth',2); 
e_ps42 = log(e_ps42); plot(N,e_ps42,'o-','LineWidth',2); 
e_ps44 = log(e_ps44); plot(N,e_ps44,'o-','LineWidth',2); 
e_ps46 = log(e_ps46); plot(N,e_ps46,'o-','LineWidth',2); 
title('$\mu = 10^{-4}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a4 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ps61 = log(e_ps61); plot(N,e_ps61,'o-','LineWidth',2); 
e_ps62 = log(e_ps62); plot(N,e_ps62,'o-','LineWidth',2); 
e_ps64 = log(e_ps64); plot(N,e_ps64,'o-','LineWidth',2); 
e_ps66 = log(e_ps66); plot(N,e_ps66,'o-','LineWidth',2); 
title('$\mu = 10^{-6}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

linkaxes([a1 a2 a3 a4],'xy')
legend('1-st order slope','$K = 10^0$','$K = 10^{-2}$','$K = 10^{-4}$', '$K = 10^{-6}$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex','FontSize',18)
xlabel(t,'$1/h$','Interpreter','latex','FontSize',20)
ylabel(t,'$\| p_S - p_{S,h} \|_{0}$', 'Interpreter','latex','FontSize',20)

%% ud
figure('units','normalized','position',[0.15,0.3,0.75,0.3]);
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud11 = log(e_ud11); plot(N,e_ud11,'o-','LineWidth',2); 
e_ud12 = log(e_ud12); plot(N,e_ud12,'o-','LineWidth',2); 
e_ud14 = log(e_ud14); plot(N,e_ud14,'o-','LineWidth',2); 
e_ud16 = log(e_ud16); plot(N,e_ud16,'o-','LineWidth',2); 
title('$\mu = 10^0$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud21 = log(e_ud21); plot(N,e_ud21,'o-','LineWidth',2); 
e_ud22 = log(e_ud22); plot(N,e_ud22,'o-','LineWidth',2); 
e_ud24 = log(e_ud24); plot(N,e_ud24,'o-','LineWidth',2); 
e_ud26 = log(e_ud26); plot(N,e_ud26,'o-','LineWidth',2); 
title('$\mu = 10^{-2}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud41 = log(e_ud41); plot(N,e_ud41,'o-','LineWidth',2); 
e_ud42 = log(e_ud42); plot(N,e_ud42,'o-','LineWidth',2); 
e_ud44 = log(e_ud44); plot(N,e_ud44,'o-','LineWidth',2); 
e_ud46 = log(e_ud46); plot(N,e_ud46,'o-','LineWidth',2); 
title('$\mu = 10^{-4}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

a4 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_ud61 = log(e_ud61); plot(N,e_ud61,'o-','LineWidth',2); 
e_ud62 = log(e_ud62); plot(N,e_ud62,'o-','LineWidth',2); 
e_ud64 = log(e_ud64); plot(N,e_ud64,'o-','LineWidth',2); 
e_ud66 = log(e_ud66); plot(N,e_ud66,'o-','LineWidth',2); 
title('$\mu = 10^{-6}$','Interpreter','latex','FontSize',18); box on;
ax = gca;
ax.FontSize = 16;

linkaxes([a1 a2 a3 a4],'xy')
legend('1-st order slope','$K = 10^0$','$K = 10^{-2}$','$K = 10^{-4}$', '$K = 10^{-6}$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex','FontSize',18)
xlabel(t,'$1/h$','Interpreter','latex','FontSize',20)
ylabel(t,'$\| \mathbf{u}_D - \mathbf{u}_{D,h} \|_{0}$', 'Interpreter','latex','FontSize',20)


%% pd 
figure('units','normalized','position',[0.15,0.3,0.75,0.3]);
t = tiledlayout(1,4,"TileSpacing","compact");

a1 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_pd11 = log(e_pd11); plot(N,e_pd11,'o-','LineWidth',2); 
e_pd12 = log(e_pd12); plot(N,e_pd12,'o-','LineWidth',2); 
e_pd14 = log(e_pd14); plot(N,e_pd14,'o-','LineWidth',2); 
e_pd16 = log(e_pd16); plot(N,e_pd16,'o-','LineWidth',2); 
box on;
title('$\mu = 10^0$','Interpreter','latex','FontSize',18);
ax = gca;
ax.FontSize = 16;

a2 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %2nd order slope
e_pd21 = log(e_pd21); plot(N,e_pd21,'o-','LineWidth',2); 
e_pd22 = log(e_pd22); plot(N,e_pd22,'o-','LineWidth',2); 
e_pd24 = log(e_pd24); plot(N,e_pd24,'o-','LineWidth',2); 
e_pd26 = log(e_pd26); plot(N,e_pd26,'o-','LineWidth',2); 
box on;
title('$\mu = 10^{-2}$','Interpreter','latex','FontSize',18);
ax = gca;
ax.FontSize = 16;

a3 = nexttile; hold on;
plot(N,-N,'--','LineWidth',2)   %1nd order slope
e_pd41 = log(e_pd41); plot(N,e_pd41,'o-','LineWidth',2); 
e_pd42 = log(e_pd42); plot(N,e_pd42,'o-','LineWidth',2); 
e_pd44 = log(e_pd44); plot(N,e_pd44,'o-','LineWidth',2); 
e_pd46 = log(e_pd46); plot(N,e_pd46,'o-','LineWidth',2); 
box on;
title('$\mu = 10^{-4}$','Interpreter','latex','FontSize',18);
ax = gca;
ax.FontSize = 16;

a4 = nexttile; hold on; 
plot(N,-N,'--','LineWidth',2)   %1nd order slope
e_pd61 = log(e_pd61); plot(N,e_pd61,'o-','LineWidth',2); 
e_pd62 = log(e_pd62); plot(N,e_pd62,'o-','LineWidth',2); 
e_pd64 = log(e_pd64); plot(N,e_pd64,'o-','LineWidth',2); 
e_pd66 = log(e_pd66); plot(N,e_pd66,'o-','LineWidth',2); 
box on; 
title('$\mu = 10^{-6}$','Interpreter','latex','FontSize',18);
ax = gca;
ax.FontSize = 16;

linkaxes([a1 a2 a3 a4],'xy')
legend('1-st order slope','$K = 10^0$','$K = 10^{-2}$','$K = 10^{-4}$', '$K = 10^{-6}$',...
    'Location','bestoutside','Orientation','vertical', 'Interpreter','latex','FontSize',18)
xlabel(t,'$1/h$','Interpreter','latex','FontSize',20)
ylabel(t,'$\| p_D - p_{D,h} \|_{0}$', 'Interpreter','latex','FontSize',20)
